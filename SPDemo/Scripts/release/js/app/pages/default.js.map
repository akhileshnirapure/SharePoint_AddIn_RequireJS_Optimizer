{"version":3,"file":"default.js","sources":["default.js"],"names":["application","$","p_logger","appModule","init","document","ready","getUserName","context","load","user","executeQueryAsync","onGetUserNameSuccess","onGetUserNameFail","text","get_title","sender","args","alert","get_message","logger","log","SP","ClientContext","get_current","get_web","get_currentUser","Init","define"],"mappings":"AAEA,GAAAA,aAAA,SAAAC,EAAAC,GAEA,GAAAC,GAAA,WAIA,QAAAC,KAGAH,EAAAI,UAAAC,MAAA,WASA,QAAAC,KACAC,EAAAC,KAAAC,GACAF,EAAAG,kBAAAC,EAAAC,GAKA,QAAAD,KACAX,EAAA,YAAAa,KAAA,SAAAJ,EAAAK,aAIA,QAAAF,GAAAG,EAAAC,GACAC,MAAA,kCAAAD,EAAAE,eArBAC,EAAAC,IAAA,qBAEA,IAAAb,GAAAc,GAAAC,cAAAC,cACAd,EAAAF,EAAAiB,UAAAC,iBAEAnB,KAmBAa,EAAAC,IAAA,sBA9BA,GAAAD,GAAA,GAAAlB,GAAA,OAmCA,QACAyB,KAAAvB,GAKA,OAAAD,GAIAyB,QAAA,qBAAA,SAAA,uBAAA5B","sourcesContent":["'use strict';\r\n\r\nvar application = function ($,p_logger) {\r\n\r\n    var appModule = function () {\r\n\r\n        var logger = new p_logger(\"Demo\");\r\n\r\n        function init() {\r\n\r\n            // This code runs when the DOM is ready and creates a context object which is needed to use the SharePoint object model\r\n            $(document).ready(function () {\r\n                logger.log(\"Application Start.\")\r\n\r\n                var context = SP.ClientContext.get_current();\r\n                var user = context.get_web().get_currentUser();\r\n\r\n                getUserName();\r\n\r\n                // This function prepares, loads, and then executes a SharePoint query to get the current users information\r\n                function getUserName() {\r\n                    context.load(user);\r\n                    context.executeQueryAsync(onGetUserNameSuccess, onGetUserNameFail);\r\n                }\r\n\r\n                // This function is executed if the above call is successful\r\n                // It replaces the contents of the 'message' element with the user name\r\n                function onGetUserNameSuccess() {\r\n                    $('#message').text('Hello ' + user.get_title());\r\n                }\r\n\r\n                // This function is executed if the above call fails\r\n                function onGetUserNameFail(sender, args) {\r\n                    alert('Failed to get user name. Error:' + args.get_message());\r\n                }\r\n\r\n                logger.log(\"Application End.\")\r\n\r\n            });\r\n        };\r\n\r\n        return {\r\n            Init: init\r\n\r\n        };\r\n    };\r\n    \r\n    return appModule;\r\n    \r\n};\r\n\r\ndefine('app/pages/default',['jquery', 'app/services/logger'], application);\n"]}