{"version":3,"file":"default.js","sources":["default.js"],"names":["getUserName","context","load","user","executeQueryAsync","onGetUserNameSuccess","onGetUserNameFail","$","text","get_title","sender","args","alert","get_message","application","p_logger","appModule","init","document","ready","logger","log","Init","SP","ClientContext","get_current","get_web","get_currentUser","define"],"mappings":"AAoCA,QAAAA,eACAC,QAAAC,KAAAC,MACAF,QAAAG,kBAAAC,qBAAAC,mBAKA,QAAAD,wBACAE,EAAA,YAAAC,KAAA,SAAAL,KAAAM,aAIA,QAAAH,mBAAAI,EAAAC,GACAC,MAAA,kCAAAD,EAAAE,eA/CA,GAAAC,aAAA,SAAAP,EAAAQ,GAEA,GAAAC,GAAA,WAIA,QAAAC,KAGAV,EAAAW,UAAAC,MAAA,WACAC,EAAAC,IAAA,sBACArB,cACAoB,EAAAC,IAAA,sBARA,GAAAD,GAAA,GAAAL,GAAA,OAYA,QACAO,KAAAL,GAKA,OAAA,IAAAD,IAMAf,QAAAsB,GAAAC,cAAAC,cACAtB,KAAAF,QAAAyB,UAAAC,iBAuBAC,QAAA,qBAAA,SAAA,uBAAAd","sourcesContent":["'use strict';\r\n\r\nvar application = (function ($,p_logger) {\r\n\r\n    var appModule = function () {\r\n\r\n        var logger = new p_logger(\"Demo\");\r\n\r\n        function init() {\r\n\r\n            // This code runs when the DOM is ready and creates a context object which is needed to use the SharePoint object model\r\n            $(document).ready(function () {\r\n                logger.log(\"Application Start.\")\r\n                getUserName();\r\n                logger.log(\"Application End.\")\r\n            });\r\n        };\r\n\r\n        return {\r\n            Init: init\r\n\r\n        };\r\n    };\r\n\r\n    return new appModule();\r\n    \r\n});\r\n\r\n\r\n\r\nvar context = SP.ClientContext.get_current();\r\nvar user = context.get_web().get_currentUser();\r\n\r\n\r\n\r\n// This function prepares, loads, and then executes a SharePoint query to get the current users information\r\nfunction getUserName() {\r\n    context.load(user);\r\n    context.executeQueryAsync(onGetUserNameSuccess, onGetUserNameFail);\r\n}\r\n\r\n// This function is executed if the above call is successful\r\n// It replaces the contents of the 'message' element with the user name\r\nfunction onGetUserNameSuccess() {\r\n    $('#message').text('Hello ' + user.get_title());\r\n}\r\n\r\n// This function is executed if the above call fails\r\nfunction onGetUserNameFail(sender, args) {\r\n    alert('Failed to get user name. Error:' + args.get_message());\r\n}\r\n\r\n\r\n//define(['vendors/jquery-private', 'services/logger'], application);\r\ndefine('app/pages/default',['jquery', 'app/services/logger'], application);\n"]}